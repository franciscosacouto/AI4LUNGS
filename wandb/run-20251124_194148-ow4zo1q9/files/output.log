LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name          | Type       | Params
---------------------------------------------
0 | survival_head | Sequential | 37.0 K
---------------------------------------------
37.0 K    Trainable params
0         Non-trainable params
37.0 K    Total params
0.148     Total estimated model params size (MB)
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=55` in the `DataLoader` to improve performance.
Sanity Checking: |          | 0/? [00:00<?, ?it/s]TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 0 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/113103_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 1 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/101692_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 2 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/100913_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.9392857
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 3 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/120701_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 4 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/110987_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 5 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/117025_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.99426085
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 6 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/209095_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.99857146
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 7 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/118323_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.83214283
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 8 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/217438_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.9222857
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 9 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/107328_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 10 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/111243_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 11 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/112575_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 12 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/204909_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.8489757
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 13 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/130133_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 14 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/125353_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 15 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/207391_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 16 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/213972_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 17 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/109965_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 18 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/126967_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.8966515
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 19 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/107791_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 20 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/112285_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 21 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/105974_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 22 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/200066_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.9085714
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 23 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/205283_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.83674395
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 24 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/102161_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 25 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/202128_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 26 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/126823_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 27 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/216793_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.9373708
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 28 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/120011_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 29 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/103619_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 30 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/126836_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.8681429
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 31 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/107434_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 32 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/134408_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 33 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/214419_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 34 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/200683_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.97507405
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 35 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/208944_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 36 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/107561_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 37 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/126520_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 38 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/215101_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 39 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/213485_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 40 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/207347_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 41 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/207584_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 42 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/218307_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 43 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/106498_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 44 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/213439_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 45 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/134491_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 46 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/128944_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 47 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/124190_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.8159971
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 48 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/117601_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 49 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/110253_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.97814286
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 50 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/201979_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 51 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/119358_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 52 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/106000_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 53 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/123515_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 54 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/216370_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.976
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 55 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/119029_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.8686865
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 56 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/133640_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.9142857
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 57 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/104564_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 58 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/120410_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.9614286
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 59 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/211570_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 60 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/107151_1.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 0.93073004
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 61 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/100158_2.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 62 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/210462_0.npy (512, 256) float32
TYPE: <class 'numpy.ndarray'>
DTYPE: float32
SHAPE: (512, 256)
MIN: 0.0
MAX: 1.0
FIRST 20: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DEBUG: 63 /nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/preprocessed_data/protocol_5/2d/lung/106046_0.npy (512, 256) float32
Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
Error executing job with overrides: []
Traceback (most recent call last):
  File "/nas-ctm01/homes/fmferreira/AI4LUNGS/encoder_decoder_approach.py", line 279, in main
    trainer.fit(lightning_model, dataloader_train, dataloader_val)
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 989, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self._run_sanity_check()
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1062, in _run_sanity_check
    val_loop.run()
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/loops/utilities.py", line 182, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 134, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 391, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 403, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/AI4LUNGS/encoder_decoder_approach.py", line 118, in validation_step
    log_hz = self(x)
             ^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/AI4LUNGS/encoder_decoder_approach.py", line 102, in forward
    embeddings = self.encode_batch(x)
                 ^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/AI4LUNGS/encoder_decoder_approach.py", line 92, in encode_batch
    out = self.encoder.encode(images=base64_list)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/medimageinsightmodel.py", line 175, in encode
    output["image_embeddings"] = self.model.encode_image(images).cpu().numpy()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/UniCLModel.py", line 161, in encode_image
    x = self.image_encoder.forward_features(image)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/ImageEncoder/davit_v1.py", line 621, in forward_features
    x, input_size = checkpoint.checkpoint(block, x, input_size)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/_compile.py", line 24, in inner
    return torch._dynamo.disable(fn, recursive)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 328, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/_dynamo/external_utils.py", line 17, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 451, in checkpoint
    return CheckpointFunction.apply(function, preserve, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/autograd/function.py", line 539, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 230, in forward
    outputs = run_function(*args)
              ^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/ImageEncoder/davit_v1.py", line 27, in forward
    inputs = module(*inputs)
             ^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/ImageEncoder/davit_v1.py", line 27, in forward
    inputs = module(*inputs)
             ^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/ImageEncoder/davit_v1.py", line 365, in forward
    x, size = self.window_attn(x, size)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/ImageEncoder/davit_v1.py", line 43, in forward
    x, size = self.fn(self.norm(x), *args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/MedImageInsights/MedImageInsight/ImageEncoder/davit_v1.py", line 319, in forward
    attn = (q @ k.transpose(-2, -1))
            ~~^~~~~~~~~~~~~~~~~~~~~
RuntimeError: Deterministic behavior was enabled with either `torch.use_deterministic_algorithms(True)` or `at::Context::setDeterministicAlgorithms(true)`, but this operation is not deterministic because it uses CuBLAS and you have CUDA >= 10.2. To enable deterministic behavior in this case, you must set an environment variable before running your PyTorch application: CUBLAS_WORKSPACE_CONFIG=:4096:8 or CUBLAS_WORKSPACE_CONFIG=:16:8. For more information, go to https://docs.nvidia.com/cuda/cublas/index.html#cublasApi_reproducibility
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.