LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name           | Type              | Params
-----------------------------------------------------
0 | survival_head  | Sequential        | 149 K
1 | vision_encoder | DaViT             | 360 M
2 | auroc_metric   | BinaryAUROC       | 0
3 | f1score        | BinaryF1Score     | 0
4 | stats_metric   | BinaryStatScores  | 0
5 | loss_fn        | BCEWithLogitsLoss | 0
-----------------------------------------------------
360 M     Trainable params
0         Non-trainable params
360 M     Total params
1,443.145 Total estimated model params size (MB)

Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:21<00:00,  0.05it/s]
==================================================
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!
Epoch 0:   0%|          | 0/8 [00:00<?, ?it/s]







Epoch 0: 100%|██████████| 8/8 [01:04<00:00,  0.12it/s, v_num=vqv9]
==================================================25<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 1: 100%|██████████| 8/8 [01:00<00:00,  0.13it/s, v_num=vqv9, val_loss=1.240]
==================================================23<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 2: 100%|██████████| 8/8 [00:56<00:00,  0.14it/s, v_num=vqv9, val_loss=1.240]

==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!









Epoch 3: 100%|██████████| 8/8 [01:05<00:00,  0.12it/s, v_num=vqv9, val_loss=1.240]
==================================================25<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 4: 100%|██████████| 8/8 [01:10<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 5: 100%|██████████| 8/8 [01:12<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================23<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!









Epoch 6: 100%|██████████| 8/8 [01:11<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!









Epoch 7: 100%|██████████| 8/8 [01:06<00:00,  0.12it/s, v_num=vqv9, val_loss=1.240]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 8: 100%|██████████| 8/8 [01:13<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================21<00:00,  0.05it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 9: 100%|██████████| 8/8 [01:01<00:00,  0.13it/s, v_num=vqv9, val_loss=1.240]
==================================================24<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 10: 100%|██████████| 8/8 [01:12<00:00,  0.11it/s, v_num=vqv9, val_loss=1.250]
==================================================24<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!









Epoch 11: 100%|██████████| 8/8 [01:03<00:00,  0.13it/s, v_num=vqv9, val_loss=1.250]
==================================================23<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 12: 100%|██████████| 8/8 [01:09<00:00,  0.11it/s, v_num=vqv9, val_loss=1.250]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 13: 100%|██████████| 8/8 [01:08<00:00,  0.12it/s, v_num=vqv9, val_loss=1.250]
==================================================22<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 14: 100%|██████████| 8/8 [01:04<00:00,  0.12it/s, v_num=vqv9, val_loss=1.250]
==================================================28<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 15: 100%|██████████| 8/8 [01:22<00:00,  0.10it/s, v_num=vqv9, val_loss=1.250]
==================================================28<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 16: 100%|██████████| 8/8 [01:22<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================28<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 17: 100%|██████████| 8/8 [01:25<00:00,  0.09it/s, v_num=vqv9, val_loss=1.240]
==================================================28<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 18: 100%|██████████| 8/8 [01:25<00:00,  0.09it/s, v_num=vqv9, val_loss=1.240]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 19: 100%|██████████| 8/8 [01:10<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 20: 100%|██████████| 8/8 [01:15<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 21: 100%|██████████| 8/8 [01:25<00:00,  0.09it/s, v_num=vqv9, val_loss=1.240]
==================================================31<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 22: 100%|██████████| 8/8 [01:22<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================28<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 23: 100%|██████████| 8/8 [01:13<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================24<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 24: 100%|██████████| 8/8 [01:17<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================28<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 25: 100%|██████████| 8/8 [01:15<00:00,  0.11it/s, v_num=vqv9, val_loss=1.240]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 26: 100%|██████████| 8/8 [01:18<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 27: 100%|██████████| 8/8 [01:19<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================28<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 78, 1s = 2
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 28: 100%|██████████| 8/8 [01:23<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 29: 100%|██████████| 8/8 [01:24<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 30: 100%|██████████| 8/8 [01:17<00:00,  0.10it/s, v_num=vqv9, val_loss=1.240]

==================================================28<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 78, 1s = 2
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 31: 100%|██████████| 8/8 [01:26<00:00,  0.09it/s, v_num=vqv9, val_loss=1.230]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 77, 1s = 3
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 32: 100%|██████████| 8/8 [01:25<00:00,  0.09it/s, v_num=vqv9, val_loss=1.230]

==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 77, 1s = 3
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 33: 100%|██████████| 8/8 [01:16<00:00,  0.11it/s, v_num=vqv9, val_loss=1.230]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 77, 1s = 3
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 34: 100%|██████████| 8/8 [01:17<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 77, 1s = 3
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 35: 100%|██████████| 8/8 [01:27<00:00,  0.09it/s, v_num=vqv9, val_loss=1.230]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 77, 1s = 3
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 36: 100%|██████████| 8/8 [01:23<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 76, 1s = 4
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 37: 100%|██████████| 8/8 [01:07<00:00,  0.12it/s, v_num=vqv9, val_loss=1.230]

==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 76, 1s = 4
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 38: 100%|██████████| 8/8 [01:16<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================21<00:00,  0.05it/s]
Stage: VAL
Predicted class distribution: 0s = 76, 1s = 4
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 39: 100%|██████████| 8/8 [01:13<00:00,  0.11it/s, v_num=vqv9, val_loss=1.230]

==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 77, 1s = 3
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 40: 100%|██████████| 8/8 [01:19<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 76, 1s = 4
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 41: 100%|██████████| 8/8 [01:17<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 74, 1s = 6
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 42: 100%|██████████| 8/8 [01:07<00:00,  0.12it/s, v_num=vqv9, val_loss=1.230]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 43: 100%|██████████| 8/8 [01:14<00:00,  0.11it/s, v_num=vqv9, val_loss=1.230]
==================================================23<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 44: 100%|██████████| 8/8 [01:21<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================28<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 45: 100%|██████████| 8/8 [01:22<00:00,  0.10it/s, v_num=vqv9, val_loss=1.230]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 46: 100%|██████████| 8/8 [01:20<00:00,  0.10it/s, v_num=vqv9, val_loss=1.220]

==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 47: 100%|██████████| 8/8 [01:22<00:00,  0.10it/s, v_num=vqv9, val_loss=1.220]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 48: 100%|██████████| 8/8 [01:18<00:00,  0.10it/s, v_num=vqv9, val_loss=1.220]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 49: 100%|██████████| 8/8 [01:17<00:00,  0.10it/s, v_num=vqv9, val_loss=1.220]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 50: 100%|██████████| 8/8 [01:15<00:00,  0.11it/s, v_num=vqv9, val_loss=1.220]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 51: 100%|██████████| 8/8 [01:19<00:00,  0.10it/s, v_num=vqv9, val_loss=1.220]
==================================================27<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 71, 1s = 9
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.









Epoch 52: 100%|██████████| 8/8 [01:26<00:00,  0.09it/s, v_num=vqv9, val_loss=1.220]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 72, 1s = 8
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 53: 100%|██████████| 8/8 [01:12<00:00,  0.11it/s, v_num=vqv9, val_loss=1.220]
==================================================19<00:00,  0.05it/s]
Stage: VAL
Predicted class distribution: 0s = 72, 1s = 8
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 54: 100%|██████████| 8/8 [01:12<00:00,  0.11it/s, v_num=vqv9, val_loss=1.220]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 72, 1s = 8
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 55: 100%|██████████| 8/8 [01:15<00:00,  0.11it/s, v_num=vqv9, val_loss=1.220]
==================================================26<00:00,  0.04it/s]
Stage: VAL
Predicted class distribution: 0s = 71, 1s = 9
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 56: 100%|██████████| 8/8 [01:26<00:00,  0.09it/s, v_num=vqv9, val_loss=1.220]
==================================================30<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 71, 1s = 9
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 57: 100%|██████████| 8/8 [01:15<00:00,  0.11it/s, v_num=vqv9, val_loss=1.220]
==================================================29<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 70, 1s = 10
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 58: 100%|██████████| 8/8 [01:18<00:00,  0.10it/s, v_num=vqv9, val_loss=1.220]
==================================================28<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 69, 1s = 11
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 59: 100%|██████████| 8/8 [01:30<00:00,  0.09it/s, v_num=vqv9, val_loss=1.220]
==================================================33<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 69, 1s = 11
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.

Epoch 59: 100%|██████████| 8/8 [02:09<00:00,  0.06it/s, v_num=vqv9, val_loss=1.220]
`Trainer.fit` stopped: `max_epochs=60` reached.
Testing: |          | 0/? [00:00<?, ?it/s]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/lightning_fabric/plugins/environments/slurm.py:191: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python encoder_decoder_approach.py ...

Testing DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
Testing DataLoader 0: 100%|██████████| 1/1 [00:32<00:00,  0.03it/s]
==================================================
Stage: TEST
Predicted class distribution: 0s = 69, 1s = 11
Actual label distribution:  0s = 59, 1s = 21
Actual Imbalance Ratio (0:1): 2.81:1
==================================================
✅ Model is predicting both classes.
Testing DataLoader 0: 100%|██████████| 1/1 [00:32<00:00,  0.03it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        test_auroc         │    0.6448748707771301     │
│  test_balanced_accuracy   │    0.5359160900115967     │
│       test_f1_score       │           0.25            │
└───────────────────────────┴───────────────────────────┘