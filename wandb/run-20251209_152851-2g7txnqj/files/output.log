LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name           | Type              | Params
-----------------------------------------------------
0 | survival_head  | Sequential        | 149 K
1 | vision_encoder | DaViT             | 360 M
2 | auroc_metric   | BinaryAUROC       | 0
3 | f1score        | BinaryF1Score     | 0
4 | stats_metric   | BinaryStatScores  | 0
5 | loss_fn        | BCEWithLogitsLoss | 0
-----------------------------------------------------
360 M     Trainable params
0         Non-trainable params
360 M     Total params
1,443.145 Total estimated model params size (MB)

Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
Sanity Checking DataLoader 0: 100%|██████████| 1/1 [00:34<00:00,  0.03it/s]
==================================================
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 0: 100%|██████████| 8/8 [01:42<00:00,  0.08it/s, v_num=xnqj]
==================================================33<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 1: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]

==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 2: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 3: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================33<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 4: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 5: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 6: 100%|██████████| 8/8 [01:44<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================33<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 7: 100%|██████████| 8/8 [01:44<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 8: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]

==================================================35<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 9: 100%|██████████| 8/8 [01:52<00:00,  0.07it/s, v_num=xnqj, val_loss=1.240]
==================================================37<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 10: 100%|██████████| 8/8 [01:51<00:00,  0.07it/s, v_num=xnqj, val_loss=1.240]
==================================================37<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 11: 100%|██████████| 8/8 [01:53<00:00,  0.07it/s, v_num=xnqj, val_loss=1.240]

==================================================35<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!








Epoch 12: 100%|██████████| 8/8 [01:42<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 80, 1s = 0
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
⚠️ Model is predicting only class 0 (majority class). It is ignoring the minority class!







Epoch 13: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================33<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.







Epoch 14: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================33<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.







Epoch 15: 100%|██████████| 8/8 [01:43<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]
==================================================32<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.







Epoch 16: 100%|██████████| 8/8 [01:45<00:00,  0.08it/s, v_num=xnqj, val_loss=1.240]

==================================================31<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.








Epoch 17: 100%|██████████| 8/8 [01:52<00:00,  0.07it/s, v_num=xnqj, val_loss=1.240]
==================================================34<00:00,  0.03it/s]
Stage: VAL
Predicted class distribution: 0s = 79, 1s = 1
Actual label distribution:  0s = 55, 1s = 25
Actual Imbalance Ratio (0:1): 2.20:1
==================================================
✅ Model is predicting both classes.
Epoch 17: 100%|██████████| 8/8 [02:27<00:00,  0.05it/s, v_num=xnqj, val_loss=1.240]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/lightning_fabric/plugins/environments/slurm.py:191: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python encoder_decoder_approach.py --config-name config_mas ...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

Testing DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
Testing DataLoader 0: 100%|██████████| 1/1 [00:35<00:00,  0.03it/s]
==================================================
Stage: TEST
Predicted class distribution: 0s = 73, 1s = 7
Actual label distribution:  0s = 59, 1s = 21
Actual Imbalance Ratio (0:1): 2.81:1
==================================================
✅ Model is predicting both classes.
Testing DataLoader 0: 100%|██████████| 1/1 [00:35<00:00,  0.03it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        test_auroc         │    0.5609362721443176     │
│  test_balanced_accuracy   │    0.47296205163002014    │
│       test_f1_score       │    0.0714285746216774     │
└───────────────────────────┴───────────────────────────┘
Error executing job with overrides: []
Traceback (most recent call last):
  File "/nas-ctm01/homes/fmferreira/AI4LUNGS/encoder_decoder_approach.py", line 217, in main
    save_results_to_excel(results_file_path, test_results)
  File "/nas-ctm01/homes/fmferreira/AI4LUNGS/encoder_decoder_approach.py", line 95, in save_results_to_excel
    new_df.to_excel(file_path, index=False)
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pandas/core/generic.py", line 2414, in to_excel
    formatter.write(
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pandas/io/formats/excel.py", line 943, in write
    writer = ExcelWriter(
             ^^^^^^^^^^^^
  File "/nas-ctm01/homes/fmferreira/.conda/envs/ai4lungs/lib/python3.11/site-packages/pandas/io/excel/_openpyxl.py", line 57, in __init__
    from openpyxl.workbook import Workbook
ModuleNotFoundError: No module named 'openpyxl'
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.